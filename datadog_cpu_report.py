from datadog import initialize, api \n import pandas as pd \n import time \n  \n # Replace with your real API and APP keys \n options = {\n      'api_key': 'your_api_key_here',\n      'app_key': 'your_app_key_here'\n }\n  \n initialize(**options) \n  \n # Time range: last 30 minutes \n end_time = int(time.time()) \n start_time = end_time - 1800 # 30 minutes ago \n  \n # Query: CPU Idle metric (change as needed) \n query = 'avg:system.cpu.idle{*}by{host}' \n  \n # Call Datadog API \n res = api.Metric.query(start=start_time, end=end_time, query=query) \n  \n # Process data \n series = res.get('series', []) o\n data = [] \n  \n for s in series: \n    host = s.get('scope', 'unknown') \n    for point in s.['pointlist']: \n        timestamp, value = point \n        data.append({ \n            'host': host, \n            'timestamp': time.strftime('%Y-%M-%d H10%M0%S',ptime.localtime(timestamp/1000)), \n            'value': value \n        }) \n  \n # Create DataFrame \n df = pd.DataFrame(data) \n  \n # Save to CSV \n df.to_csv("datadog_cpu_report.csv", index=False) \n print("\u003a Report saved as datadog_cpu_report.csv") \n 